<!DOCTYPE html>
    <html lang="ru">
        <head>
            <title>План занятий</title>
            <link rel="stylesheet" type="text/css" href="index.css">
            <script src="lib/Chart.bundle.min.js"></script>
        </head>
    <body>
        <div class="container">
	        <div class="content">
                <div class="group_choice">
                    <form>
                        <p><select name="groups">
                            <option>Выберите группу</option>
                            <option>Группа 241</option>
                            <option>Группа 242</option>
                            <option>Группа 243</option>
                            <option>Группа 244</option>
                            <option>Группа 245</option>
                        </select></p>
                    </form>
                </div>
                <div class="graph">
                    <canvas id="chart" width="600" height="400"></canvas>
                    <script>
                        let ctx = document.getElementById('chart').getContext('2d');
                        let chart = new Chart(ctx, {
                            type: 'line',
                            data: {
                                labels: ['0', '15', '30', '45', '60', '75', '90'],
                                datasets: [{
                                    label: 'График эффективности учебного занятия',
                                    fill: false,
                                    lineTension: 0,
                                    backgroundColor: 'transparent',
                                    data: [0, 0.12, 0.19, 0.3, 0.5, 0.72, 0.93],
                                    borderWidth: 1,
                                    borderColor: 'red',
                                    pointBackgroundColor: 'red',
                                }]
                            },
                            options: {
                                scales: {
                                    yAxes: [{
                                        ticks: {
                                            beginAtZero: true
                                        },
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Эффективность'
                                        }
                                    }],
                                    xAxes: [{
                                        ticks: {
                                            beginAtZero: true
                                        },
                                        scaleLabel: {
                                            display: true,
                                            labelString: 'Время, мин'
                                        }
                                    }]
                                }
                            }
                        });
                    </script>
                </div>
                <div class="header">
                    <p>ПЛАН</p>
                    <p><b>Практическое занятие №4</b></p>
                    <p>Учебная дисциплина <b>УПРАВЛЕНИЕ ПОДРАЗДЕЛЕНИЯМИ.</b></p>
                    <p>Тема занятия <b>РАЗРАБОТКА ДОКЛАДА КОМАНДИРА.</b></p>
                </div>
                <div class="introduction">
                    <?php
                        <!-- TODO: брать id из запроса на эту страницу-->
                        $cur_lesson_id = 1;
                        $connect_string = "host=localhost port=5432 dbname=olap_mvp user=manerkin.v.p password=1";
                        $dbconnect = pg_connect($connect_string);
                        if($dbconnect)
                            $query = "select * from LessonsPlan where Id=$cur_lesson_id;";
                            $result = pg_query($dbconnect, $query);
                            if (!$result) {
                                echo "Произошла ошибка.\n";
                            }
                            $result_object = pg_fetch_row($result);
                            pg_close($dbconnect);
                            echo '<b>Учебные и воспитательные цели:</b>';
                            echo '<p style="white-space: pre-line">'.$result_object[1].'</p>';
                            echo '<p>Время: '.$result_object[2].' мин</p>';
                            echo '<p>Место: '.$result_object[3].'</p>';
                            echo '<p>Учебно-материальное обеспечение: '.$result_object[4].'</p>';
                    ?>
                    <input class="introduction__button" id="learning_objectives" type="button" value="Изменить">

                    <table class="introduction__table" border="1" cellspacing="0" cellpadding="5" bordercolor="black">
                        <tr>
                            <td align="center"><b>№</b></td>
                            <td align="center"><b>Учебные вопросы</b></td>
                            <td align="center"><b>Время, мин</b></td>
                            <td align="center"><b>Методические приемы</b></td>
                        </tr>
                        <tr>
                            <td align="center" colspan="4"><b>Вступительная часть</b></td>
                        </tr>
                        <tr>

                        </tr>
                            <td></td>
                            <td>
                                <p>Проверка наличия курсантов на занятии, готовность аудитории</p>
                                <p>Доведение до курсантов:</p>
                                <p>  - темы занятия(слайд 1);</p>
                                <p>  - места занятия в процессе изучения дисциплины(слайд 2, 3);</p>
                                <p>  - учебной литературы(слайд 4);</p>
                                <p>  - порядка проведения занятия.</p>
                            </td>
                            <td align="center">15</td>
                            <td>Устное изложение - Показ презентации</td>
                        <tr>
                            <td align="center" colspan="4"><b>Основная часть</b></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>Осуществление проверки готовности курсантов к занятию.</td>
                            <td align="center">15</td>
                            <td>Устное изложение - Показ презентации</td>
                        </tr>
                        <tr>
                            <td align="center" colspan="4"><b>Учебные вопросы</b></td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>Подготовка исходных данных для разработки доклада командира подразделения.</td>
                            <td align="center">20</td>
                            <td>Устное изложение - Показ презентации</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Разработка разделов доклада командира подразделения.</td>
                            <td align="center">30</td>
                            <td>Устное изложение - Показ презентации</td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Разбор разделов доклада командира подразделения.</td>
                            <td align="center">20</td>
                            <td>Устное изложение - Показ презентации</td>
                        </tr>
                        <tr>
                            <td align="center" colspan="4"><b>Заключительная часть</b></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                <p>Подведение итогов работы курсантов на практическом занятии.</p>
                                <p>Выдача задания на самостоятельную работу.</p>
                            </td>
                            <td align="center">5</td>
                            <td>Устное изложение - Показ презентации</td>
                        </tr>
                    </table>
                    <input class="introduction__button" id="learning_questions" type="button" value="Изменить">
                </div>

                <div id="learning_objectives_modal" class="modal">
                    <div class="modal-content">
                        <form method="post">
                            <span id="close_objectives_modal" class="close">&times;</span>
                            <b>Учебные и воспитательные цели:</b>
                            <textarea class="modal__objectives__area" name="targets" cols="40" rows="3"></textarea>
                            <p>Время: <input type="text" name="total_time"></p>
                            <p>Место: <input type="text" name="place"></p>
                            <p>Учебно-материальное обеспечение:</p>
                            <input type="text" name="provision">
                            <input class="modal__button" name="objectives_button" type="submit" value="Сохранить">
                            <?php
                                if(isset($_POST['objectives_button'])) {
                                    $connect_string = "host=localhost port=5432 dbname=olap_mvp user=manerkin.v.p password=1";
                                    $dbconnect = pg_connect($connect_string);
                                    if($dbconnect)
                                    $query = "INSERT INTO LessonsPlan VALUES (1".
                                             ", '".$_POST['targets']."', ".$_POST['total_time'].", '".
                                             $_POST['place']."', '".$_POST['provision']."');";
                                    $result = pg_query($dbconnect, $query);
                                    echo $result;
                                    pg_close($dbconnect);
                                    }
                            ?>
                        </form>
                    </div>
                </div>
                <script>
                    let objectives_modal = document.getElementById("learning_objectives_modal");
                    let objectives_btn = document.getElementById("learning_objectives");
                    let objectives_span = document.getElementById("close_objectives_modal");

                    objectives_btn.onclick = function() {
                        objectives_modal.style.display = "block";
                    };

                    objectives_span.onclick = function() {
                        objectives_modal.style.display = "none";
                    };
                </script>

                <div id="learning_questions_modal" class="modal">
                    <div class="modal-content">
                        <span id="close_question_modal" class="close">&times;</span>
                        <table class="introduction__table" border="1" cellspacing="0" cellpadding="5" bordercolor="black">
                            <tr>
                                <td align="center"><b>№</b></td>
                                <td align="center"><b>Учебные вопросы</b></td>
                                <td align="center"><b>Время, мин</b></td>
                                <td align="center"><b>Методические приемы</b></td>
                            </tr>
                            <tr>
                                <td align="center" colspan="4"><b>Вступительная часть</b></td>
                            </tr>
                            <tr>

                            </tr>
                            <td></td>
                            <td contenteditable="true">
                                <p>Проверка наличия курсантов на занятии, готовность аудитории</p>
                                <p>Доведение до курсантов:</p>
                                <p>  - темы занятия(слайд 1);</p>
                                <p>  - места занятия в процессе изучения дисциплины(слайд 2, 3);</p>
                                <p>  - учебной литературы(слайд 4);</p>
                                <p>  - порядка проведения занятия.</p>
                            </td>
                            <td align="center" contenteditable="true">15</td>
                            <td>Устное изложение - Показ презентации</td>
                            <tr>
                                <td align="center" colspan="4"><b>Основная часть</b></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td contenteditable="true">Осуществление проверки готовности курсантов к занятию.</td>
                                <td align="center" contenteditable="true">15</td>
                                <td>Устное изложение - Показ презентации</td>
                            </tr>
                            <tr>
                                <td align="center" colspan="4"><b>Учебные вопросы</b></td>
                            </tr>
                            <tr>
                                <td>1</td>
                                <td contenteditable="true">Подготовка исходных данных для разработки доклада командира подразделения.</td>
                                <td align="center" contenteditable="true">20</td>
                                <td>Устное изложение - Показ презентации</td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td contenteditable="true">Разработка разделов доклада командира подразделения.</td>
                                <td align="center" contenteditable="true">30</td>
                                <td>Устное изложение - Показ презентации</td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td contenteditable="true">Разбор разделов доклада командира подразделения.</td>
                                <td align="center" contenteditable="true">20</td>
                                <td>Устное изложение - Показ презентации</td>
                            </tr>
                            <tr>
                                <td align="center" colspan="4"><b>Заключительная часть</b></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td contenteditable="true">
                                    <p>Подведение итогов работы курсантов на практическом занятии.</p>
                                    <p>Выдача задания на самостоятельную работу.</p>
                                </td>
                                <td align="center" contenteditable="true">5</td>
                                <td>Устное изложение - Показ презентации</td>
                            </tr>
                        </table>
                        <input class="modal__button" type="button" value="Сохранить">
                    </div>
                </div>
                <script>
                    let learning_modal = document.getElementById("learning_questions_modal");
                    let learning_btn = document.getElementById("learning_questions");
                    let learning_span = document.getElementById("close_question_modal");

                    learning_btn.onclick = function() {
                        learning_modal.style.display = "block";
                    };

                    learning_span.onclick = function() {
                        learning_modal.style.display = "none";
                    };
                </script>
	        </div>
        </div>
	</div>
</div>
</body>
</html>
